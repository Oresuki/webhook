-- Fish It Game Detector Script (Delta Executor Compatible - Simplified HTTP)
-- Mendeteksi ikan tertangkap, isi backpack, dan rarity items
-- Dengan Discord Webhook Integration

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local HttpService = game:GetService("HttpService")
local player = Players.LocalPlayer

-- URL WEBHOOK ANDA (URL telah dikonfirmasi dan dimasukkan)
local WEBHOOK_URL = "https://discord.com/api/webhooks/1415137396290224239/ubcezXBLeK03AhRtLcLQcq-dI2j1PGwa3QREOOIQTAY4ZazFFcgI2nuQBQRTc9DzP97A"

-- Settings
local SEND_ALL_CATCHES = false -- Set true untuk kirim semua catch, false untuk rare saja
local MIN_RARITY_TO_SEND = "Rare" -- Minimum rarity untuk kirim ke Discord

-- Tabel rarity colors untuk Discord embed
local rarityColors = {
Â  Â  Common = 16777215, Â  Â  Â -- White
Â  Â  Uncommon = 5635925, Â  Â  -- Green
Â  Â  Rare = 5592575, Â  Â  Â  Â  -- Blue
Â  Â  Epic = 11141375, Â  Â  Â  Â -- Purple
Â  Â  Legendary = 16755200, Â  -- Orange/Gold
Â  Â  Mythic = 16733695, Â  Â  Â -- Pink/Magenta
Â  Â  SECRET = 16711680 Â  Â  Â  -- Red
}

-- Tabel priority rarity (untuk filter)
local rarityPriority = {
Â  Â  Common = 1,
Â  Â  Uncommon = 2,
Â  Â  Rare = 3,
Â  Â  Epic = 4,
Â  Â  Legendary = 5,
Â  Â  Mythic = 6,
Â  Â  SECRET = 7
}

-- Function untuk send webhook ke Discord (Disederhanakan untuk kompatibilitas lebih baik)
local function sendWebhook(embed)
Â  Â  if not WEBHOOK_URL then
Â  Â  Â  Â  warn("âŒ Discord Webhook URL not configured!")
Â  Â  Â  Â  return false
Â  Â  end
Â  Â  
Â  Â  local data = {
Â  Â  Â  Â  ["embeds"] = {embed}
Â  Â  }
Â  Â  
Â  Â  local jsonData = HttpService:JSONEncode(data)
Â  Â  
Â  Â  -- Mencoba http_request atau request secara langsung (lebih sederhana dari pcall)
Â  Â  local success, result
Â  Â  
Â  Â  if http_request then
Â  Â  Â  Â  success, result = pcall(function()
Â  Â  Â  Â  Â  Â  return http_request({
Â  Â  Â  Â  Â  Â  Â  Â  Url = WEBHOOK_URL,
Â  Â  Â  Â  Â  Â  Â  Â  Method = "POST",
Â  Â  Â  Â  Â  Â  Â  Â  Headers = { ["Content-Type"] = "application/json" },
Â  Â  Â  Â  Â  Â  Â  Â  Body = jsonData
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  end)
Â  Â  elseif request then
Â  Â  Â  Â  success, result = pcall(function()
Â  Â  Â  Â  Â  Â  return request({
Â  Â  Â  Â  Â  Â  Â  Â  Url = WEBHOOK_URL,
Â  Â  Â  Â  Â  Â  Â  Â  Method = "POST",
Â  Â  Â  Â  Â  Â  Â  Â  Headers = { ["Content-Type"] = "application/json" },
Â  Â  Â  Â  Â  Â  Â  Â  Body = jsonData
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  end)
Â  Â  elseif syn and syn.request then
Â  Â  Â  Â  success, result = pcall(function()
Â  Â  Â  Â  Â  Â  return syn.request({
Â  Â  Â  Â  Â  Â  Â  Â  Url = WEBHOOK_URL,
Â  Â  Â  Â  Â  Â  Â  Â  Method = "POST",
Â  Â  Â  Â  Â  Â  Â  Â  Headers = { ["Content-Type"] = "application/json" },
Â  Â  Â  Â  Â  Â  Â  Â  Body = jsonData
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  end)
Â  Â  else
Â  Â  Â  Â  warn("âŒ No HTTP request function available (Delta/Roblox API is not exposed).")
Â  Â  Â  Â  return false
Â  Â  end
Â  Â  
Â  Â  if success and result and (result.StatusCode == 204 or result.Success) then
Â  Â  Â  Â  print("âœ… Webhook sent to Discord!")
Â  Â  Â  Â  return true
Â  Â  elseif success then
Â  Â  Â  Â  -- Webhook failed but request succeeded (e.g., Discord returned error code)
Â  Â  Â  Â  warn("âŒ Failed to send webhook (Discord error): " .. tostring(result.StatusCode or "Unknown Status"))
Â  Â  Â  Â  return false
Â  Â  else
Â  Â  Â  Â  warn("âŒ Failed to execute HTTP request: " .. tostring(result))
Â  Â  Â  Â  return false
Â  Â  end
end

-- Function untuk parse backpack dari GUI
local function parseBackpackFromGUI()
Â  Â  local backpackData = {
Â  Â  Â  Â  items = {},
Â  Â  Â  Â  totalWeight = 0,
Â  Â  Â  Â  maxWeight = 4500,
Â  Â  Â  Â  rarityCounts = {
Â  Â  Â  Â  Â  Â  Common = 0, Uncommon = 0, Rare = 0, Epic = 0, Legendary = 0, Mythic = 0, SECRET = 0
Â  Â  Â  Â  }
Â  Â  }
Â  Â  
Â  Â  local playerGui = player:WaitForChild("PlayerGui", 5)
Â  Â  if not playerGui then return backpackData end
Â  Â  
Â  Â  for _, gui in pairs(playerGui:GetDescendants()) do
Â  Â  Â  Â  if gui:IsA("TextLabel") or gui:IsA("TextBox") then
Â  Â  Â  Â  Â  Â  local text = gui.Text
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  -- Parse weight (format: "X.XXX/X.XXX")
Â  Â  Â  Â  Â  Â  local current, max = text:match("(%d+%.%d+)/(%d+%.%d+)")
Â  Â  Â  Â  Â  Â  if current and max then
Â  Â  Â  Â  Â  Â  Â  Â  backpackData.totalWeight = tonumber(current) * 1000
Â  Â  Â  Â  Â  Â  Â  Â  backpackData.maxWeight = tonumber(max) * 1000
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  -- Parse rarity counts (Cari 'Rarity: X' atau 'Rarity X')
Â  Â  Â  Â  Â  Â  for rarity, _ in pairs(rarityPriority) do
Â  Â  Â  Â  Â  Â  Â  Â  local count = text:match(rarity .. "%s*:%s*(%d+)") or text:match(rarity .. "%s*(%d+)")
Â  Â  Â  Â  Â  Â  Â  Â  if count then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  backpackData.rarityCounts[rarity] = tonumber(count)
Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  end
Â  Â  end
Â  Â  
Â  Â  return backpackData
end

-- Fungsi shouldSendToDiscord dan printBackpackStatus tidak diubah karena sudah benar...

local function shouldSendToDiscord(rarity)
Â  Â  if SEND_ALL_CATCHES then
Â  Â  Â  Â  return true
Â  Â  end
Â  Â  local minPriority = rarityPriority[MIN_RARITY_TO_SEND] or 3
Â  Â  local itemPriority = rarityPriority[rarity] or 1
Â  Â  return itemPriority >= minPriority
end

local function printBackpackStatus()
Â  Â  local data = parseBackpackFromGUI()
Â  Â  print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
Â  Â  print("ğŸ“¦ BACKPACK STATUS")
Â  Â  print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
Â  Â  print(string.format("âš–ï¸ Weight: %.3f/%.3f KG (%.1f%%)", data.totalWeight/1000, data.maxWeight/1000, (data.totalWeight/data.maxWeight) * 100))
Â  Â  print("\nâœ¨ Rarity Breakdown:")
Â  Â  for rarity, count in pairs(data.rarityCounts) do
Â  Â  Â  Â  if count > 0 then
Â  Â  Â  Â  Â  Â  print(string.format(" Â %s: %d", rarity, count))
Â  Â  Â  Â  end
Â  Â  end
Â  Â  print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n")
end

-- Monitor chat untuk fish caught messages
local function monitorChat()
Â  Â  local chatEvents = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
Â  Â  if chatEvents then
Â  Â  Â  Â  local onMessageDoneFiltering = chatEvents:FindFirstChild("OnMessageDoneFiltering")
Â  Â  Â  Â  if onMessageDoneFiltering then
Â  Â  Â  Â  Â  Â  onMessageDoneFiltering.OnClientEvent:Connect(function(messageData)
Â  Â  Â  Â  Â  Â  Â  Â  local message = messageData.Message
Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  if message:find("You Got:") or message:find("You got:") then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  task.wait(1.5) -- Ditingkatkan untuk stabilitas
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local fishName = message:match("You [Gg]ot:%s*(.-)%s*%(") or message:match("You [Gg]ot:%s*(.-)%s*,") or "Unknown Fish"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local weight = message:match("weight:%s*([%d%.]+)") or "0"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local price = message:match("price:%s*(%d+)") or "0"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local mutations = message:match("mutations:%s*([^,%)]+)") or "None"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local rarity = "Common"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for r, _ in pairs(rarityPriority) do
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if message:lower():find(r:lower()) then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rarity = r
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  break
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print("ğŸ£ FISH CAUGHT!")
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print("ğŸŸ Fish: " .. fishName)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print("âœ¨ Rarity: " .. rarity)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n")
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  task.wait(1)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  printBackpackStatus()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if shouldSendToDiscord(rarity) then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local bpData = parseBackpackFromGUI()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local rarityText = ""
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  for r, count in pairs(bpData.rarityCounts) do
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if count > 0 then
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  rarityText = rarityText .. string.format("%s: %d\n", r, count)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  local embed = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ["title"] = "ğŸ£ Fish Caught!",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ["description"] = string.format("**%s** has been caught!", fishName),
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ["color"] = rarityColors[rarity] or 16777215,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ["fields"] = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { ["name"] = "ğŸ“Š Fish Info", ["value"] = string.format("**Rarity:** %s\n**Weight:** %s KG\n**Price:** %s coins\n**Mutations:** %s", rarity, weight, price, mutations), ["inline"] = true },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { ["name"] = "ğŸ’ Backpack", ["value"] = string.format("**Weight:** %.2f/%.2f KG\n**Usage:** %.1f%%", bpData.totalWeight/1000, bpData.maxWeight/1000, (bpData.totalWeight/bpData.maxWeight) * 100), ["inline"] = true },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { ["name"] = "âœ¨ Rarity Count", ["value"] = rarityText ~= "" and rarityText or "No items", ["inline"] = false }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ["footer"] = { ["text"] = player.Name .. " â€¢ Fish It Detector" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ["timestamp"] = os.date("!%Y-%m-%dT%H:%M:%SZ")
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sendWebhook(embed)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  Â  Â  end
Â  Â  Â  Â  Â  Â  end)
Â  Â  Â  Â  end
Â  Â  end
end

-- Initialize
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
print("ğŸ£ Fish It Detector Script Loaded!")
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
print("ğŸ“± Executor: Delta (Simplified HTTP)")
print("ğŸ”— Webhook: âœ… Configured")
print("ğŸ“Š Min Rarity: " .. MIN_RARITY_TO_SEND)
print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n")

-- Commands (tidak diubah)
_G.FishDetector = {
Â  Â  checkBackpack = printBackpackStatus,
Â  Â  testWebhook = function()
Â  Â  Â  Â  local embed = {
Â  Â  Â  Â  Â  Â  ["title"] = "ğŸ§ª Webhook Test",
Â  Â  Â  Â  Â  Â  ["description"] = "Test message from Fish It Detector!",
Â  Â  Â  Â  Â  Â  ["color"] = 65280,
Â  Â  Â  Â  Â  Â  ["fields"] = {
Â  Â  Â  Â  Â  Â  Â  Â  { ["name"] = "Player", ["value"] = player.Name, ["inline"] = true },
Â  Â  Â  Â  Â  Â  Â  Â  { ["name"] = "Status", ["value"] = "âœ… Connected", ["inline"] = true }
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  ["timestamp"] = os.date("!%Y-%m-%dT%H:%M:%SZ")
Â  Â  Â  Â  }
Â  Â  Â  Â  sendWebhook(embed)
Â  Â  end,
Â  Â  setMinRarity = function(rarity)
Â  Â  Â  Â  if rarityPriority[rarity] then
Â  Â  Â  Â  Â  Â  MIN_RARITY_TO_SEND = rarity
Â  Â  Â  Â  Â  Â  print("âœ… Minimum rarity set to: " .. rarity)
Â  Â  Â  Â  else
Â  Â  Â  Â  Â  Â  print("âŒ Invalid rarity! Options: Common, Uncommon, Rare, Epic, Legendary, Mythic, SECRET")
Â  Â  Â  Â  end
Â  Â  end,
Â  Â  setSendAll = function(value)
Â  Â  Â  Â  SEND_ALL_CATCHES = value
Â  Â  Â  Â  print("âœ… Send all catches: " .. tostring(value))
Â  Â  end
}

print("ğŸ“ Commands:")
print(" Â _G.FishDetector.checkBackpack()")
print(" Â _G.FishDetector.testWebhook()")
print(" Â _G.FishDetector.setMinRarity('Epic')")
print(" Â _G.FishDetector.setSendAll(true)")
print("\nâ³ Monitoring for fish catches...\n")

-- Start monitoring
monitorChat()
task.wait(1)
printBackpackStatus()
